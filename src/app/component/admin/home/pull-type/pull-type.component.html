<nz-modal [(nzVisible)]="isPullTypeModalVisible" nzTitle={{pullTypeModalHeader}} (nzOnCancel)="handleCancel()"
    [nzFooter]="activityModalFooter" nzWidth="75%" [nzOkLoading]="isConfirmPullTypeLoading">
    <ng-template #activityModalFooter>
        <div class="modal-footer-btn">
            <a nz-button nzType="link" (click)="handleCancel()">Cancel</a>
            <button nz-button nzType="primary" (click)="updatePullTypeForm()" [nzLoading]="isConfirmPullTypeLoading">SAVE</button>
        </div>
    </ng-template>
    <ng-container *nzModalContent>
        <div nz-row>
            <div nz-col [nzSpan]="24">
                <form nz-form class="staff-form" [nzLayout]="pullTypeForm.get('formLayout')?.value"
                    [formGroup]="pullTypeForm">
                    <div nz-row class="tabStyle">
                        <div nz-col [nzSpan]="24">
                            <div nz-row class="form_section">
                                <div nz-row [nzGutter]="24" class="full-width-container">
                                    <div nz-col [nzSpan]="8">
                                        <nz-form-item>
                                            <nz-form-label class="lable-style">Pull Type</nz-form-label>
                                            <nz-form-control nzErrorTip="Please Enter Pull Type">
                                                <input nz-input type="text" formControlName="pullType"
                                                    [(ngModel)]="existingPullTypeData.pullType"
                                                    placeholder="Pull Type" readonly class="disInputStyle"/>
                                            </nz-form-control>
                                        </nz-form-item>
                                    </div>

                                    <div nz-col [nzSpan]="16">
                                        <div nz-row [nzGutter]="24">
                                            <div nz-col [nzSpan]="4">
                                                <nz-form-item>
                                                    <nz-form-label class="lable-style">&nbsp;</nz-form-label>
                                                    <nz-form-control nzErrorTip="">
                                                        <label class="lable-checkbox1"
                                                            [(ngModel)]="existingPullTypeData.numeric" nz-checkbox
                                                            formControlName="numeric">Numeric</label>
                                                    </nz-form-control>
                                                </nz-form-item>
                                            </div>
                                            <div nz-col [nzSpan]="4">
                                                <nz-form-item>
                                                    <nz-form-label class="lable-style">&nbsp;</nz-form-label>
                                                    <nz-form-control nzErrorTip="">
                                                        <label class="lable-checkbox1"
                                                            [(ngModel)]="existingPullTypeData.apr" nz-checkbox
                                                            formControlName="apr">APR</label>
                                                    </nz-form-control>
                                                </nz-form-item>
                                            </div>
                                            <div nz-col [nzSpan]="4">
                                                <nz-form-item>
                                                    <nz-form-label class="lable-style">&nbsp;</nz-form-label>
                                                    <nz-form-control nzErrorTip="">
                                                        <label class="lable-checkbox1"
                                                            [(ngModel)]="existingPullTypeData.noEdit" nz-checkbox
                                                            formControlName="noEdit">No Edit</label>
                                                    </nz-form-control>
                                                </nz-form-item>
                                            </div>
                                            <div nz-col [nzSpan]="5">
                                                <nz-form-item>
                                                    <nz-form-label class="lable-style">&nbsp;</nz-form-label>
                                                    <nz-form-control nzErrorTip="">
                                                        <label class="lable-checkbox1"
                                                            [(ngModel)]="existingPullTypeData.isPrimary" nz-checkbox
                                                            formControlName="isPrimary">Is Primary</label>
                                                    </nz-form-control>
                                                </nz-form-item>
                                            </div>
                                        </div>
                                    </div>

                                    <div nz-col [nzSpan]="8">
                                        <nz-form-item>
                                            <nz-form-label class="lable-style">Sort Order</nz-form-label>
                                            <nz-form-control nzErrorTip="Please Enter Sort Order">
                                                <input nz-input type="text" formControlName="sortOrder"
                                                    [(ngModel)]="existingPullTypeData.sortOrder"
                                                    placeholder="Sort Order" />
                                            </nz-form-control>
                                        </nz-form-item>
                                    </div>

                                    <div nz-col [nzSpan]="8">
                                        <nz-form-item>
                                            <nz-form-label class="lable-style">Program Type</nz-form-label>
                                            <nz-form-control nzErrorTip="Please Select Program Type">
                                                <nz-select nzShowSearch nzAllowClear formControlName="programType"
                                                    [(ngModel)]="existingPullTypeData.programType"
                                                    nzPlaceHolder="Program Type">
                                                    <nz-option *ngFor="let program of programList"
                                                        [nzLabel]="program.value" [nzValue]="program.id">
                                                    </nz-option>
                                                </nz-select>
                                            </nz-form-control>
                                        </nz-form-item>
                                    </div>

                                    <div nz-col [nzSpan]="8">
                                        <nz-form-item>
                                            <nz-form-label class="lable-style">Ser Type</nz-form-label>
                                            <nz-form-control nzErrorTip="Please Enter Ser Type">
                                                <input nz-input type="number" formControlName="serType"
                                                    [(ngModel)]="existingPullTypeData.serType" placeholder="Ser Type" />
                                            </nz-form-control>
                                        </nz-form-item>
                                    </div>

                                    <div nz-col [nzSpan]="8">
                                        <nz-form-item class="flexArr">
                                            <nz-form-label class="lable-style">Data Fields</nz-form-label>
                                            <nz-form-control nzErrorTip="Please Enter Data Fields">
                                                <textarea formControlName="dataFields" nz-input
                                                    placeholder="Enter Data Fields"
                                                    [(ngModel)]="existingPullTypeData.dataFields"
                                                    [nzAutosize]="{ minRows: 3, maxRows: 3 }">
                                                </textarea>
                                            </nz-form-control>
                                        </nz-form-item>
                                    </div>

                                    <div nz-col [nzSpan]="16">
                                        <nz-form-item class="flexArr">
                                            <nz-form-label class="lable-style">Pull Description</nz-form-label>
                                            <nz-form-control nzErrorTip="Please Enter Pull Description">
                                                <textarea formControlName="pullDescription" nz-input
                                                    placeholder="Enter Pull Description"
                                                    [(ngModel)]="existingPullTypeData.pullDescription"
                                                    [nzAutosize]="{ minRows: 3, maxRows: 3 }">
                                                </textarea>
                                            </nz-form-control>
                                        </nz-form-item>
                                    </div>

                                    <div nz-col [nzSpan]="16">
                                        <nz-form-item class="flexArr">
                                            <nz-form-label class="lable-style">Quick Edit Description</nz-form-label>
                                            <nz-form-control nzErrorTip="Please Enter Quick Edit Description">
                                                <textarea formControlName="quickEditDescription" nz-input
                                                    placeholder="Enter Quick Edit Description"
                                                    [(ngModel)]="existingPullTypeData.quickEditDescription"
                                                    [nzAutosize]="{ minRows: 3, maxRows: 3 }">
                                                </textarea>
                                            </nz-form-control>
                                        </nz-form-item>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>

    </ng-container>
</nz-modal>
<!--Edit Modal End-->

<div class="custom-body">
    <div nz-row class="page-alignment">
        <div nz-col [nzSpan]="24">
            <form nz-form class="staff-form" [nzLayout]="pullTypeFilterForm.get('formLayout')?.value"
                [formGroup]="pullTypeFilterForm">
                <div nz-row [nzGutter]="24" class="full-width-container">
                    <div nz-col [nzSpan]="20">
                        <div nz-row [nzGutter]="24">
                            <div nz-col [nzSpan]="6">
                                <nz-form-item class="search-filter-item">
                                    <nz-form-label class="lable-style">Description</nz-form-label>
                                    <nz-form-control nzErrorTip="Please Enter Description ">
                                        <input nz-input type="text" formControlName="description"
                                            placeholder="Description" [(ngModel)]="filterDescription" />
                                    </nz-form-control>
                                </nz-form-item>
                            </div>
        
                            <div nz-col [nzSpan]="6">
                                <nz-form-item class="search-filter-item">
                                    <nz-form-label class="lable-style">Pulltype</nz-form-label>
                                    <nz-form-control nzErrorTip="Please Enter Pulltype">
                                        <input nz-input type="text" formControlName="pullType"
                                            placeholder="Pulltype" [(ngModel)]="filterPullType" />
                                    </nz-form-control>
                                </nz-form-item>
                            </div>
        
                            <div nz-col [nzSpan]="6">
                                <nz-form-item class="search-filter-item">
                                    <nz-form-label class="lable-style">Program Type</nz-form-label>
                                    <nz-form-control>
                                        <nz-select nzShowSearch nzAllowClear nzPlaceHolder="Program Type" [(ngModel)]="filterProgramType" formControlName="programType">
                                            <nz-option *ngFor="let program of programList" [nzLabel]="program.value"
                                                [nzValue]="program.id">
                                            </nz-option>
                                        </nz-select>
                                    </nz-form-control>
                                </nz-form-item>
                            </div>
                            
                            <div nz-col [nzSpan]="5">
                                <div nz-row [nzGutter]="24">
                                    <div nz-col [nzSpan]="12">
                                        <nz-form-item class="search-filter-item">
                                            <nz-form-control>
                                                <button nz-button nzType="primary" class="search-filter-btn" [nzLoading]="isSearchPullTypeLoading" (click)="searchPullType()">
                                                    <i nz-icon nzType="search" class="search-filter-icon"></i>
                                                    Search
                                                  </button>
                                            </nz-form-control>
                                        </nz-form-item>
                                    </div>
        
                                    <div nz-col [nzSpan]="12">
                                        <nz-form-item class="search-filter-item">
                                            <nz-form-control>
                                                <button nz-button nzType="primary" class="search-filter-btn" [nzLoading]="resetProcess" (click)="resetFilters()">
                                                    <i nz-icon nzType="undo" class="search-filter-icon"></i>
                                                    Reset
                                                </button>
                                            </nz-form-control>
                                        </nz-form-item>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div nz-col [nzSpan]="3" nzOffset="1">
                        <nz-form-item class="search-filter-item">
                            <nz-form-control>
                                <button nz-button nzType="primary" class="search-filter-btn" (click)="exportExcel()">
                                    <i nz-icon nzType="download" class="search-filter-icon"></i>
                                    Download
                                  </button>
                            </nz-form-control>
                        </nz-form-item>
                        
                    </div>
                    
                </div>
            </form>
            <div nz-row>
                <div nz-col [nzSpan]="24">
                    <nz-table #staffDetails [nzData]="pullTypeData" [nzPageSize]="10" [nzLoading]="dataLoading">
                        <thead>
                            <tr>
                                <th [nzWidth]="'490px'">Pull Description</th>
                                <th [nzWidth]="'250px'">Pull Type</th>
                                <th [nzWidth]="'110px'">Program Type</th>
                                <th [nzWidth]="'250px'">Sort Order</th>
                                <th [nzWidth]="'50px'">APR</th>
                                <th [nzWidth]="'60px'">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let data of staffDetails.data">
                                <td>{{ data.pullDesc }}</td>
                                <td>{{ data.pullType }}</td>
                                <td>{{ data.projType }}</td>
                                <td>{{ data.sortOrder }}</td>
                                <td>{{ data.apr }}</td>
                                <td class="edit-icon-div">
                                    <i class="edit-icon" nz-icon nzType="edit" nzTheme="outline" nz-tooltip
                                        nzTooltipTitle="Edit Pull Type" (click)="updatePullType(data.pullTypeId)"
                                        nzTooltipPlacement="bottom" nz-button>
                                    </i>
                                </td>
                            </tr>
                        </tbody>
                    </nz-table>
                </div>
            </div>
        </div>
    </div>
</div>